# 规则配置仅供参考，适用于最新的 Surge iOS & Mac (Version 4.5.1 Build 1866, macv4-a9346fb8)
# 参考 https://github.com/scomper/Surge/blob/master/surge3.conf.ini
# 参考 https://gist.github.com/Blankwonder/dca87b84b1052f4a6a277dce73e9c01a

[General]
# 通用
internet-test-url = http://captive.apple.com/
proxy-test-url = http://cp.cloudflare.com/generate_204
test-timeout = 3
# TLS Provider: default, Secure Transport, OpenSSL
tls-provider = default
wifi-assist = false
geoip-maxmind-url = https://cdn.jsdelivr.net/gh/Hackl0us/GeoIP2-CN@release/Country.mmdb
# 是否启动完整的 IPv6 支持 (默认值: false)
ipv6 = false

# Wi-Fi 访问
# Surge 作为 HTTP/SOCKS5 代理服务器向 Wi-Fi 网络下的其他设备提供服务器
allow-wifi-access = false
# Surge Mac 供外网访问的服务端口
# HTTP 服务端口 (默认值: 6152)
# http-listen = 0.0.0.0:6152
# SOCKS5 服务端口 (默认值: 6153)
# socks5-listen = 0.0.0.0:6153
#
# Surge iOS 供外网访问的服务端口
# HTTP 服务端口 (默认值: 6152)
# wifi-access-http-port = 6152
# SOCKS5 服务端口 (默认值: 6153)
# wifi-access-socks5-port = 6153

# 远程控制器
# 允许外部控制器访问 Surge，Surge Dashboard 或 Surge CLI 进行管理控制
external-controller-access = BlueGrave@0.0.0.0:6170
http-api = BlueGrave@0.0.0.0:6171

# 兼容性
# compatibility-mode = 0
# 跳过某个域名或者 IP 段，这些目标主机将不会由 Surge Proxy 处理。
# (macOS 版本中，如果启用了 Set as System Proxy, 这些值会被写入到系统网络代理设置.)
skip-proxy = 192.168.0.0/16, 193.168.0.0/24, 172.16.0.0/12, 100.64.0.0/10, 10.0.0.0/8, 17.0.0.0/8, ::ffff:0.0.0.0/1, ::ffff:128.0.0.0/1, localhost, *.local, *.crashlytics.com
bypass-system = true

# DNS 设置
# 强制使用特定的 DNS 服务器
dns-server = 223.5.5.5, 223.6.6.6, 1.0.0.1, 1.1.1.1
doh-server = https://dns.alidns.com/dns-query, https://dns.rubyfish.cn/dns-query, https://cloudflare-dns.com/dns-query, https://dns.twnic.tw/dns-query
doh-format = wireformat
doh-follow-outbound-mode = false

# TCP Force HTTP Hosts
force-http-engine-hosts = 123.59.31.1, 119.18.193.135, 122.14.246.33, 175.102.178.52
# VIF Excluded Routes
tun-excluded-routes = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12
# VIF Included Routes
tun-included-routes = 192.168.1.12/32

# 实验性功能
network-framework = false

# 高级
# 日志等级: warning, notify, info, verbose (默认值: notify)
loglevel = info
show-error-page-for-reject = true
# 不包括简单主机名
exclude-simple-hostnames = true
hijack-dns = 8.8.8.8:53, 8.8.4.4:53
always-real-ip = *.srv.nintendo.net, *.stun.playstation.net, xbox.*.microsoft.com, *.xboxlive.com, *.nextdns.io

# 该段定义抓取流量的过滤
[Replica]
# 隐藏所有发往 *.Apple.com 和 *.icloud.com 的请求
# （该选项只是在抓取结果中隐藏了请求）
hide-apple-request = 1
# 隐藏 Crashlytics 请求
hide-crash-reporter-request = 1
# 隐藏 UDP 会话
hide-udp = 0
# 关键词过滤器
keyword-filter-type = none

# 该段定义可用的代理策略
# 针对所有类型代理的选项:
#   interface: 可选 (默认值: null)
#   强制使用特定的出口地址或网络设备 (仅 macOS 版可用)
#   例如: ProxyHTTP = http, 1.2.3.4, 443, username, password, interface = en2
#   en1 = direct, interface = en1
# 针对启用了 TLS 的代理的选项:
#   skip-common-name-verify: "true" 或 "false" (默认值: false)
#   如果启动该选择, Surge 不会校验证书名是否符合
[Proxy]
# 写法是 策略名 = 代理类型,代理地址，端口号，用户名，密码
# 不同的类型填写的具体项目会有差异，建议在 UI 界面中填写
# 策略名不可重复，策略名须先定义才能在其它部分引用
# Proxy01 = https,adc-us.com,443,username = 用户名,password = 密码
# Proxy02 = ss, abc-kt.com, 443, encrypt-method = rc4-md5, password = 密码
# Proxy03 = socks5, abc-cn.com, 443, username = 用户名, password = 密码
#
# 利用服务器定义的方式实现的广告通过选择
#   Ad-Pass 不拦截广告
#   Ad-Block 直接拒绝
#   Ad-GIF 返回一个透明像素图
# Ad-Pass = direct
# Ad-Block = reject
# Ad-GIF = reject-tinygif

# 该段定义可用的策略组
# 有 4 种策略组类型: "select", "url-test"，"fallback" 和 "ssid"
#	select: 具体哪个子策略将被使用，由用户界面上进行选择。
#	url-test: 具体哪个子策略将被使用，通过测试到具体 URL 的访问速度选择
#   参数:
#   url: 必填
#   测试时用到的目标 URL.
#   interval: 可选, 秒 (默认值: 600s)
#   指定在多长时间后，上次的测试结果将被抛弃。
#   tolerance: 可选, 毫秒 (默认值: 100ms)
#   只有当新的优选线路，比原优选线路的响应时间，大于该值的时候，才会触发线路变更。
#   timeout: 可选, 秒 (默认值: 5s)
#   如果某策略在该时间后依然没有完成，放弃该策略。
#	fallback: 具体哪个子策略将被使用，通过测试到具体 URL 的可用性决定
#	ssid: 具体哪个子策略将被使用，根据 Wi-FI 的 SSID 决定
#   参数:
#   default: 必填
#   默认策略。
#   cellular: 可选
#   在数据网络下的策略。 若不填，那么默认策略将被使用。
[Proxy Group]
# Proxy = select, Auto, Proxy01 , Proxy02, Proxy03
# 以代理服务器的选择模式实现广告的通过选择
# AdBlock = select, Ad-GIF,Ad-Block,Ad-Pass
# 场景选择模式
#	缺省走 Auto；蜂窝网络走 Proxy01；
# 	接入 Wi-Fi 时走 Auto（SSIDNAME 改成需要判断的 Wi-Fi 的名称）
# Scene = ssid, default = Auto, cellular = Proxy01, "SSIDNAME" = Auto
# 自动选择代理
# Auto = fallback, Proxy01, Proxy02, Proxy03, url = http://www.bing.com/
# Video 策略群组的写法，将用于视频服务的代理放在一个群组（Netflix会判断代理的地域）
# Video = url-test, policy-path=groupHK.list, url = http://www.bing.com/
#
# Video 策略组的简单写法，两种写法可选一个
# Video = url-test, Proxy02, Proxy03, url = http://www.bing.com

[Rule]
# 规则定义部分
# 触发通知，匹配规则时弹出 notification-text 定义的字符串
# DOMAIN-SUFFIX,scomper.me,DIRECT,notification-text="Welcome to scomper's blog."
# AND,((SRC-IP,10.211.55.3), (DOMAIN-SUFFIX,scomper.me)),Proxy
#
# Rulesets，规则集（每 24 小时后台自动更新）
# 规则集包含多条子规则，可以是另一个本地 list 文件，或者是一个 URL
# 内置了两个规则集：SYSTEM 和 LAN
# 内置规则集的具体内容可在 Surge Mac 设置界面查看
# RULE-SET,SYSTEM,DIRECT
# RULE-SET,LAN,DIRECT
#
# GeoIP CN，基于 GeoIP 数据库判断域名和 IP 的归属地
GEOIP,CN,DIRECT
# DNS 查询失败走 Final 规则
FINAL,Proxy,dns-failed

# 该段定义本地 DNS 记录
# 该功能等同于 /etc/hosts，加上了泛解析和别名支持。
[Host]
# 本地值
raw.githubusercontent.com = 151.101.228.133
services.googleapis.cn = 74.125.203.94
mtalk.google.com = 108.177.125.188
# 特定 DNS 服务器
*.tw = server:1.0.0.1
*testflight.apple.com = server:1.1.1.1

# 该段定义针对 HTTP 请求的 URL 重定向规则
# 有两种重定向方式: "header" 和 "302"
# Header 模式
# Surge 会修改发出的 http header，必要时还会修改 Host 字段。客户端将
# 感知不到这个重定向过程. 不支持重定向到一个 HTTPS 的地址。
# 302 模式
# Surge 直接简单的返回一个 302 重定向回应。
[URL Rewrite]

# 重定向 HTTP 请求或者篡改请求 Header
# Surge 可以在请求被发往目标服务器之前篡改请求的 Header
[Header Rewrite]

# 该段仅在 iOS 版本下生效。 
# 你可以为某些特定的 WiFi 网络设置设置参数
# 参数:
# suspend: "true" 或 "false"
# 在该网络下 Surge 将暂停工作。 请注意，如果你在该网络下直接启动 Surge，那么 
# Surge 依然会工作。只有当从其他网络切换到该网络时，Surge 才会暂停。
[SSID Setting]
# 连接到 Apple Store 的 Wi-Fi网络时 Surge 暂停工作
# 需要 Web 验证登录的 Wi-Fi 网络以及路由器已经科学上网的 Surge 挂起
# "Apple Store" suspend = true
# 计费网络模式，当连接到热点名为 iPhone X 的网络时自动切换为计费模式
# "iPhone X" cellular-mode = true

[MITM]
ca-passphrase = 68EBE527
ca-p12 = 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
